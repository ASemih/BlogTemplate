@page "{slug}"
@model PostModel
@using Microsoft.AspNetCore.Mvc.RazorPages
@addTagHelper "*, Microsoft.AspNetCore.Mvc.TagHelpers"

@{
    ViewData["Title"] = Model.Post.Title;
}


<article>
    <h1>@Model.Post.Title</h1>
    <a href="/edit/@Model.Post.Slug">Edit Post</a>
    <p id="date">@Model.Post.PubDate.ToString("MMM dd, yyyy")</p>
    <span>@string.Join(", ", Model.Post.Tags)</span>
    <p>@Model.Post.Body</p>

    <h2>Comments</h2>


    @foreach (var comment in Model.Post.Comments)
    {
        string cssClass = comment.IsPublic ? "" : "deletedContent";
        <form id="form1" method="post">
            <div class="@cssClass">
                <p id="Comment-Title">@comment.AuthorName</p>
                <p id="Comment-Body">@comment.AuthorEmail</p>
                <p id="Comment-Date">@comment.PubDate.ToString("MMM dd, yyyy")</p>
                <p id="Comment-Body">@comment.Body</p>
                <input type="hidden" name="commentId" id="commentId" value="@comment.UniqueId" />
                @if (comment.IsPublic)
                {
                    <input type="submit" name="delete" value="Delete Comment" asp-page-handler="DeleteComment" />
                }
                else
                {
                    <input type="submit" name="delete" value="Republish Comment" asp-page-handler="UndeleteComment" />
                }
            </div>
        </form>
    }

    <hr />
    <h3>Add Comment</h3>
    <form id="form1" method="post">
        @Html.ValidationSummary()
        <div class="form-group">
            @Html.LabelFor(x => Model.Comment.AuthorName, "Name")
            @Html.TextBoxFor(x => Model.Comment.AuthorName, new { @class = "form-control" })
        </div>
        <div class="form-group">
            @Html.LabelFor(x => Model.Comment.AuthorEmail, "Email")
            @Html.TextBoxFor(x => Model.Comment.AuthorEmail, new { @class = "form-control" })
        </div>
        <div class="form-group">
            @Html.LabelFor(x => Model.Comment.Body, "Write a comment...")
            @Html.TextBoxFor(x => Model.Comment.Body, new { @class = "form-control" })
        </div>
        <input type="submit" name="publish" value="Publish" asp-page-handler="PublishComment" />
    </form>
</article>